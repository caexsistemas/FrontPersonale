
<div class="card mt-6">
    <div *ngIf="view == 'create' || view == 'update'">
        <div class="card-header">
            <h5 class="modal-title">
                <p class="title-modal" *ngIf="view == 'create'">{{title}}</p>
                <p class="title-modal" *ngIf="view == 'update'">{{title}}</p>
                <button type="button" class="btn btn-primary btn-close" (click)="closeDialog()" aria-label="Close"
                    style="position: absolute;left: 90%;top: 2%;font-size: 12px;">
                    <span aria-hidden="true">&times;</span>
                </button>
            </h5>
        </div>
        <div class="card-body">
            <mat-dialog-content>
                <form *ngIf="view == 'create' || view == 'update'" [formGroup]="formCreate">

                    <div class="row">
                        <div class="col-md-4">
                            <mat-form-field class="example-full-width">
                                <mat-label>Nombre de la capacitación</mat-label>
                                <input matInput formControlName="mee_name">
                            </mat-form-field>
                        </div>
                        <div class="col-md-4">
                            <mat-form-field class="example-full-width">
                                <mat-label>Fecha de inicio:</mat-label>
                                <input matInput formControlName="mee_fec_ini" type="date">
                            </mat-form-field>
                        </div>
                        <div class="col-md-4">
                            <mat-form-field class="example-full-width">
                                <mat-label>Fecha Fin:</mat-label>
                                <input matInput formControlName="mee_fec_fin" type="date">
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="row">
                        <!-- <div class="col-md-4">
                            <mat-form-field class="example-full-width">
                            <mat-label>Grupos:</mat-label>
                            <mat-select formControlName="receiver" (ngModelChange)="onSelectionChange($event)" multiple >
                                <mat-option *ngFor="let idet of group" [value]="idet.ls_codvalue">
                                  {{idet.description}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                        </div> -->
                        <div class="col-md-4">
                            <mat-form-field class="example-full-width">
                            <mat-label>Linea de Negocio:</mat-label>
                            <mat-select formControlName="receiver" (ngModelChange)="onSelectArea($event)" multiple>
                                <mat-option *ngFor="let idet of businessLine" [value]="idet.ls_codvalue">
                                  {{idet.description}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                        </div>
                       
                        <div class="col-md-4" *ngIf="checkArea">
                            <mat-form-field class="example-full-width">
                            <mat-label>Area:</mat-label>
                            <mat-select formControlName="receiver2" (ngModelChange)="onSelectCargo($event)" multiple>
                                <mat-option *ngFor="let idet of area" [value]="idet.idArea">
                                  {{idet.area}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-md-4" *ngIf="checkCargo">
                            <mat-form-field class="example-full-width">
                            <mat-label>Cargo:</mat-label>
                            <mat-select formControlName="receiver3" (ngModelChange)="onSelectPerson($event)" multiple>
                                <mat-option *ngFor="let idet of cargo" [value]="idet.ls_codvalue">
                                  {{idet.description}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                        </div>
                     
                          <div class="col-md-4" *ngIf="checkPerson">
                            <mat-form-field class="example-full-width">
                              <mat-label>Nombre completo del trabajador</mat-label>
                              <mat-select formControlName="receiver5"  (ngModelChange)="onSelectUser($event)" multiple>
                                <mat-option *ngFor="let idet of personInfoLine" [value]="idet.idPersonale" >
                                  {{idet.name}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div>
                         
                    </div>
                    <div class="row mt-3">
                        <div class="col-md-4">
                          <label>Adjuntar Documento de Soporte:</label>
                          <input formControlName="file_sp" class="form-control" type="file" (change)="seleccionarArchivo($event)"
                            multiple>
                        </div>
                        <div class="col-md-4" *ngIf="view == 'update'">
                          <dt>Documentos de Soporte:</dt>
                          <dd>
                            <ul>
                              <li *ngFor="let archivo of selection.file_sp; let i = index;">
                                <a href="{{archivo}}" target="_blank">Download {{i+1}}</a>
                              </li>
                            </ul>
                          </dd>
                        </div>
                      </div>
                </form>
            </mat-dialog-content>
            <div mat-dialog-actions>
                <div class="text-center col-12">
                    <button *ngIf="view == 'update'" mat-button class="btn btn-success"
                        (click)="onSubmitUpdate()">Actualizar</button>

                    <button *ngIf="view == 'create'" mat-button class="btn btn-success"
                        (click)="onSubmi()">Guardar</button>

                    <button mat-button class="btn btn-danger" (click)="closeDialog()">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <div *ngIf="view == 'view'">
      <div class="modal-header">
          <h5 class="modal-title">{{title}}</h5>
          <button type="button" class="btn btn-primary btn-close" (click)="closeDialog()" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <mat-dialog-content style="min-width: 1000px;">
          <div class="row mt-2">
            
              <div class="col-md-4">
                <dt>Documentos de Soporte:</dt>
                <dd>
                  <ul>
                    <ng-container *ngFor="let archivo of selection.file_sp; let i = index;">
                      <!-- <ng-container *ngIf="esImagen(archivo)">
                        <li>
                          <img [src]="archivo" alt="Imagen {{i+1}}" />
                        </li>
                      </ng-container> -->
                      <ng-container *ngIf="esDocumentoWord(archivo)">
                        <!-- Si es un documento Word -->
                        <li>
                          <!-- Mostrar el contenido del documento Word como HTML -->
                          <!-- <div [innerHTML]="documentoHTML"></div> -->
                          <!-- <p>{{document}}</p> -->
                          <!-- <ngx-doc-viewer [src]="documentoHTML"></ngx-doc-viewer> -->
                          <!-- Botón para iniciar la generación de vista previa -->
                          <!-- <button (click)="iniciarGeneracionVistaPrevia('tuIdDeContenedor')">Generar Vista Previa</button> -->
                        </li>
                        <!-- <ngx-doc-viewer [url]="documentoHTML" viewer="google" style="width:100%;height:50vh;"></ngx-doc-viewer> -->
                        <!-- <ngx-doc-viewer
                        [url]="documentoHTML"
                        viewer="google"
                        style="width:100%;height:50vh;"
                      ></ngx-doc-viewer> -->
                      <iframe [src]="urlSafe" width="1000px" height="500px" frameborder="1"></iframe>
                      <!-- <iframe src="https://docs.google.com/gview?url={{urlSafe}}&embedded=true" width="1000" height="500"></iframe> -->
                      <!-- <iframe src='https://view.officeapps.live.com/op/embed.aspx?src={{urlSafe}}' width='px' height='px' frameborder='0'> -->
                      <!-- </iframe> -->

                      <!-- <iframe src='https://view.officeapps.live.com/op/embed.aspx?src=urlSafe' width='px' height='px' frameborder='0'></iframe> -->
                      <!-- <iframe src="https://docs.google.com/gview?url={{urlSafe}}&embedded=true" width="1000" height="500"></iframe> -->
                      <!-- <iframe [src]="urlSafe | bypassSeguro" width="1000px" height="500px" frameborder="0"></iframe> -->


                      </ng-container>
                   
                    </ng-container>
                  </ul>
                </dd>
              </div>
              
          </div>
      </mat-dialog-content>
  </div>